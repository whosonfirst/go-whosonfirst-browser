/*!
localForage -- Offline Storage, Improved
Version 1.5.4
https://localforage.github.io/localForage
(c) 2013-2017 Mozilla, Apache License 2.0
*/!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.localforage=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||void 0===a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(b){return p.reject(a,b)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;if(a&&"object"==typeof a&&"function"==typeof b)return function(){b.apply(a,arguments)}}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a(1),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=c=e,e.prototype.catch=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){g(c,this.state===r?a:b,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},c.resolve=k,c.reject=l,c.all=m,c.race=n},{1:1}],3:[function(a,b,c){(function(b){"use strict";"function"!=typeof b.Promise&&(b.Promise=a(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(a){return}}function f(){try{if(!ta)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(a){return!1}}function g(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(f){if("TypeError"!==f.name)throw f;for(var c="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,d=new c,e=0;e<a.length;e+=1)d.append(a[e]);return d.getBlob(b.type)}}function h(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function i(a,b,c){"function"==typeof b&&a.then(b),"function"==typeof c&&a.catch(c)}function j(a){return"string"!=typeof a&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function k(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function l(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}function m(a){return new wa(function(b){var c=a.transaction(xa,Aa),d=g([""]);c.objectStore(xa).put(d,"key"),c.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)},c.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);b(c||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function n(a){return"boolean"==typeof ua?wa.resolve(ua):m(a).then(function(a){return ua=a})}function o(a){var b=va[a.name],c={};c.promise=new wa(function(a,b){c.resolve=a,c.reject=b}),b.deferredOperations.push(c),b.dbReady?b.dbReady=b.dbReady.then(function(){return c.promise}):b.dbReady=c.promise}function p(a){var b=va[a.name],c=b.deferredOperations.pop();if(c)return c.resolve(),c.promise}function q(a,b){var c=va[a.name],d=c.deferredOperations.pop();if(d)return d.reject(b),d.promise}function r(a,b){return new wa(function(c,d){if(a.db){if(!b)return c(a.db);o(a),a.db.close()}var e=[a.name];b&&e.push(a.version);var f=ta.open.apply(ta,e);b&&(f.onupgradeneeded=function(b){var c=f.result;try{c.createObjectStore(a.storeName),b.oldVersion<=1&&c.createObjectStore(xa)}catch(c){if("ConstraintError"!==c.name)throw c;console.warn('The database "'+a.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+a.storeName+'" already exists.')}}),f.onerror=function(a){a.preventDefault(),d(f.error)},f.onsuccess=function(){c(f.result),p(a)}})}function s(a){return r(a,!1)}function t(a){return r(a,!0)}function u(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),d=a.version<a.db.version,e=a.version>a.db.version;if(d&&(a.version!==b&&console.warn('The database "'+a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),e||c){if(c){var f=a.db.version+1;f>a.version&&(a.version=f)}return!0}return!1}function v(a){return new wa(function(b,c){var d=new FileReader;d.onerror=c,d.onloadend=function(c){var d=btoa(c.target.result||"");b({__local_forage_encoded_blob:!0,data:d,type:a.type})},d.readAsBinaryString(a)})}function w(a){return g([l(atob(a.data))],{type:a.type})}function x(a){return a&&a.__local_forage_encoded_blob}function y(a){var b=this,c=b._initReady().then(function(){var a=va[b._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return i(c,a,a),c}function z(a){o(a);for(var b=va[a.name],c=b.forages,d=0;d<c.length;d++){var e=c[d];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return s(a).then(function(b){for(var d=0;d<c.length;d++)c[d]._dbInfo.db=b;a.db=b}).then(function(){if(u(a))return t(a)}).catch(function(b){throw q(a,b),b})}function A(a,b,c,d){void 0===d&&(d=1);try{var e=a.db.transaction(a.storeName,b);c(null,e)}catch(e){if(d>0&&(!a.db||"InvalidStateError"===e.name||"NotFoundError"===e.name))return wa.resolve().then(function(){if(!a.db||"NotFoundError"===e.name&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),t(a)}).then(function(){return z(a).then(function(){A(a,b,c,d-1)})}).catch(c);c(e)}}function B(a){function b(){return wa.resolve()}var c=this,d={db:null};if(a)for(var e in a)d[e]=a[e];va||(va={});var f=va[d.name];f||(f={forages:[],db:null,dbReady:null,deferredOperations:[]},va[d.name]=f),f.forages.push(c),c._initReady||(c._initReady=c.ready,c.ready=y);for(var g=[],h=0;h<f.forages.length;h++){var i=f.forages[h];i!==c&&g.push(i._initReady().catch(b))}var j=f.forages.slice(0);return wa.all(g).then(function(){return d.db=f.db,s(d)}).then(function(a){return d.db=a,u(d,c._defaultConfig.version)?t(d):a}).then(function(a){d.db=f.db=a,c._dbInfo=d;for(var b=0;b<j.length;b++){var e=j[b];e!==c&&(e._dbInfo.db=d.db,e._dbInfo.version=d.version)}})}function C(a,b){var c=this;a=j(a);var d=new wa(function(b,d){c.ready().then(function(){A(c._dbInfo,za,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.get(a);h.onsuccess=function(){var a=h.result;void 0===a&&(a=null),x(a)&&(a=w(a)),b(a)},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function D(a,b){var c=this,d=new wa(function(b,d){c.ready().then(function(){A(c._dbInfo,za,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.openCursor(),i=1;h.onsuccess=function(){var c=h.result;if(c){var d=c.value;x(d)&&(d=w(d));var e=a(d,c.key,i++);void 0!==e?b(e):c.continue()}else b()},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function E(a,b,c){var d=this;a=j(a);var e=new wa(function(c,e){var f;d.ready().then(function(){return f=d._dbInfo,"[object Blob]"===ya.call(b)?n(f.db).then(function(a){return a?b:v(b)}):b}).then(function(b){A(d._dbInfo,Aa,function(f,g){if(f)return e(f);try{var h=g.objectStore(d._dbInfo.storeName);null===b&&(b=void 0);var i=h.put(b,a);g.oncomplete=function(){void 0===b&&(b=null),c(b)},g.onabort=g.onerror=function(){var a=i.error?i.error:i.transaction.error;e(a)}}catch(a){e(a)}})}).catch(e)});return h(e,c),e}function F(a,b){var c=this;a=j(a);var d=new wa(function(b,d){c.ready().then(function(){A(c._dbInfo,Aa,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.delete(a);f.oncomplete=function(){b()},f.onerror=function(){d(h.error)},f.onabort=function(){var a=h.error?h.error:h.transaction.error;d(a)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function G(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){A(b._dbInfo,Aa,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.clear();e.oncomplete=function(){a()},e.onabort=e.onerror=function(){var a=g.error?g.error:g.transaction.error;c(a)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function H(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){A(b._dbInfo,za,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.count();g.onsuccess=function(){a(g.result)},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function I(a,b){var c=this,d=new wa(function(b,d){if(a<0)return void b(null);c.ready().then(function(){A(c._dbInfo,za,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=!1,i=g.openCursor();i.onsuccess=function(){var c=i.result;if(!c)return void b(null);0===a?b(c.key):h?b(c.key):(h=!0,c.advance(a))},i.onerror=function(){d(i.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function J(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){A(b._dbInfo,za,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.openCursor(),h=[];g.onsuccess=function(){var b=g.result;if(!b)return void a(h);h.push(b.key),b.continue()},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function K(a,b){b=k.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{},a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var d,e=this;if(a.name){var f=a.name===c.name&&e._dbInfo.db?wa.resolve(e._dbInfo.db):s(a);d=a.storeName?f.then(function(b){if(b.objectStoreNames.contains(a.storeName)){var c=b.version+1;o(a);for(var d=va[a.name],e=d.forages,f=0;f<e.length;f++){var g=e[f];g._dbInfo.db&&(g._dbInfo.db.close(),g._dbInfo.db=null,g._dbInfo.version=c)}return new wa(function(b,d){var e=ta.open(a.name,c);e.onerror=d,e.onupgradeneeded=function(){e.result.deleteObjectStore(a.storeName)},e.onsuccess=function(){var a=e.result;b(a)}}).then(function(a){for(var b=0;b<e.length;b++){var c=e[b];c._dbInfo.db=a,p(c._dbInfo)}}).catch(function(b){throw(q(a,b)||wa.resolve()).catch(function(){}),b})}}):f.then(function(){o(a);for(var b=va[a.name],c=b.forages,d=0;d<c.length;d++){var e=c[d];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return new wa(function(b,c){var d=ta.deleteDatabase(a.name);d.onerror=d.onblocked=c,d.onsuccess=b}).then(function(){for(var a=0;a<c.length;a++)p(e._dbInfo)}).catch(function(b){throw(q(a,b)||wa.resolve()).catch(function(){}),b})})}else d=wa.reject("Invalid arguments");return h(d,b),d}function L(){return"function"==typeof openDatabase}function M(a){var b,c,d,e,f,g=.75*a.length,h=a.length,i=0;"="===a[a.length-1]&&(g--,"="===a[a.length-2]&&g--);var j=new ArrayBuffer(g),k=new Uint8Array(j);for(b=0;b<h;b+=4)c=Ca.indexOf(a[b]),d=Ca.indexOf(a[b+1]),e=Ca.indexOf(a[b+2]),f=Ca.indexOf(a[b+3]),k[i++]=c<<2|d>>4,k[i++]=(15&d)<<4|e>>2,k[i++]=(3&e)<<6|63&f;return j}function N(a){var b,c=new Uint8Array(a),d="";for(b=0;b<c.length;b+=3)d+=Ca[c[b]>>2],d+=Ca[(3&c[b])<<4|c[b+1]>>4],d+=Ca[(15&c[b+1])<<2|c[b+2]>>6],d+=Ca[63&c[b+2]];return c.length%3==2?d=d.substring(0,d.length-1)+"=":c.length%3==1&&(d=d.substring(0,d.length-2)+"=="),d}function O(a,b){var c="";if(a&&(c=Ta.call(a)),a&&("[object ArrayBuffer]"===c||a.buffer&&"[object ArrayBuffer]"===Ta.call(a.buffer))){var d,e=Fa;a instanceof ArrayBuffer?(d=a,e+=Ha):(d=a.buffer,"[object Int8Array]"===c?e+=Ja:"[object Uint8Array]"===c?e+=Ka:"[object Uint8ClampedArray]"===c?e+=La:"[object Int16Array]"===c?e+=Ma:"[object Uint16Array]"===c?e+=Oa:"[object Int32Array]"===c?e+=Na:"[object Uint32Array]"===c?e+=Pa:"[object Float32Array]"===c?e+=Qa:"[object Float64Array]"===c?e+=Ra:b(new Error("Failed to get type for BinaryArray"))),b(e+N(d))}else if("[object Blob]"===c){var f=new FileReader;f.onload=function(){var c=Da+a.type+"~"+N(this.result);b(Fa+Ia+c)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(c){console.error("Couldn't convert value into a JSON string: ",a),b(null,c)}}function P(a){if(a.substring(0,Ga)!==Fa)return JSON.parse(a);var b,c=a.substring(Sa),d=a.substring(Ga,Sa);if(d===Ia&&Ea.test(c)){var e=c.match(Ea);b=e[1],c=c.substring(e[0].length)}var f=M(c);switch(d){case Ha:return f;case Ia:return g([f],{type:b});case Ja:return new Int8Array(f);case Ka:return new Uint8Array(f);case La:return new Uint8ClampedArray(f);case Ma:return new Int16Array(f);case Oa:return new Uint16Array(f);case Na:return new Int32Array(f);case Pa:return new Uint32Array(f);case Qa:return new Float32Array(f);case Ra:return new Float64Array(f);default:throw new Error("Unkown type: "+d)}}function Q(a,b,c,d){a.executeSql("CREATE TABLE IF NOT EXISTS "+b.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],c,d)}function R(a){var b=this,c={db:null};if(a)for(var d in a)c[d]="string"!=typeof a[d]?a[d].toString():a[d];var e=new wa(function(a,d){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(a){return d(a)}c.db.transaction(function(e){Q(e,c,function(){b._dbInfo=c,a()},function(a,b){d(b)})},d)});return c.serializer=Ua,e}function S(a,b,c,d,e,f){a.executeSql(c,d,e,function(a,g){g.code===g.SYNTAX_ERR?a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[name],function(a,h){h.rows.length?f(a,g):Q(a,b,function(){a.executeSql(c,d,e,f)},f)},f):f(a,g)},f)}function T(a,b){var c=this;a=j(a);var d=new wa(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){S(c,e,"SELECT * FROM "+e.storeName+" WHERE key = ? LIMIT 1",[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=e.serializer.deserialize(d)),b(d)},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function U(a,b){var c=this,d=new wa(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){S(c,e,"SELECT * FROM "+e.storeName,[],function(c,d){for(var f=d.rows,g=f.length,h=0;h<g;h++){var i=f.item(h),j=i.value;if(j&&(j=e.serializer.deserialize(j)),void 0!==(j=a(j,i.key,h+1)))return void b(j)}b()},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function V(a,b,c,d){var e=this;a=j(a);var f=new wa(function(f,g){e.ready().then(function(){void 0===b&&(b=null);var h=b,i=e._dbInfo;i.serializer.serialize(b,function(b,j){j?g(j):i.db.transaction(function(c){S(c,i,"INSERT OR REPLACE INTO "+i.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){f(h)},function(a,b){g(b)})},function(b){if(b.code===b.QUOTA_ERR){if(d>0)return void f(V.apply(e,[a,h,c,d-1]));g(b)}})})}).catch(g)});return h(f,c),f}function W(a,b,c){return V.apply(this,[a,b,c,1])}function X(a,b){var c=this;a=j(a);var d=new wa(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){S(c,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[a],function(){b()},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function Y(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){S(b,d,"DELETE FROM "+d.storeName,[],function(){a()},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function Z(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){S(b,d,"SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function $(a,b){var c=this,d=new wa(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){S(c,e,"SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function _(a){var b=this,c=new wa(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){S(b,d,"SELECT key FROM "+d.storeName,[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function aa(a){return new wa(function(b,c){a.transaction(function(d){d.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(c,d){for(var e=[],f=0;f<d.rows.length;f++)e.push(d.rows.item(f).name);b({db:a,storeNames:e})},function(a,b){c(b)})},function(a){c(a)})})}function ba(a,b){b=k.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{},a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var d,e=this;return d=a.name?new wa(function(b){var d;d=a.name===c.name?e._dbInfo.db:openDatabase(a.name,"","",0),b(a.storeName?{db:d,storeNames:[a.storeName]}:aa(d))}).then(function(a){return new wa(function(b,c){a.db.transaction(function(d){function e(a){return new wa(function(b,c){d.executeSql("DROP TABLE IF EXISTS "+a,[],function(){b()},function(a,b){c(b)})})}for(var f=[],g=0,h=a.storeNames.length;g<h;g++)f.push(e(a.storeNames[g]));wa.all(f).then(function(){b()}).catch(function(a){c(a)})},function(a){c(a)})})}):wa.reject("Invalid arguments"),h(d,b),d}function ca(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&"function"==typeof localStorage.setItem}catch(a){return!1}}function da(a,b){var c=a.name+"/";return a.storeName!==b.storeName&&(c+=a.storeName+"/"),c}function ea(){var a="_localforage_support_test";try{return localStorage.setItem(a,!0),localStorage.removeItem(a),!1}catch(a){return!0}}function fa(){return!ea()||localStorage.length>0}function ga(a){var b=this,c={};if(a)for(var d in a)c[d]=a[d];return c.keyPrefix=da(a,b._defaultConfig),fa()?(b._dbInfo=c,c.serializer=Ua,wa.resolve()):wa.reject()}function ha(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var d=localStorage.key(c);0===d.indexOf(a)&&localStorage.removeItem(d)}});return h(c,a),c}function ia(a,b){var c=this;a=j(a);var d=c.ready().then(function(){var b=c._dbInfo,d=localStorage.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return h(d,b),d}function ja(a,b){var c=this,d=c.ready().then(function(){for(var b=c._dbInfo,d=b.keyPrefix,e=d.length,f=localStorage.length,g=1,h=0;h<f;h++){var i=localStorage.key(h);if(0===i.indexOf(d)){var j=localStorage.getItem(i);if(j&&(j=b.serializer.deserialize(j)),void 0!==(j=a(j,i.substring(e),g++)))return j}}});return h(d,b),d}function ka(a,b){var c=this,d=c.ready().then(function(){var b,d=c._dbInfo;try{b=localStorage.key(a)}catch(a){b=null}return b&&(b=b.substring(d.keyPrefix.length)),b});return h(d,b),d}function la(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,d=[],e=0;e<c;e++){var f=localStorage.key(e);0===f.indexOf(a.keyPrefix)&&d.push(f.substring(a.keyPrefix.length))}return d});return h(c,a),c}function ma(a){var b=this,c=b.keys().then(function(a){return a.length});return h(c,a),c}function na(a,b){var c=this;a=j(a);var d=c.ready().then(function(){var b=c._dbInfo;localStorage.removeItem(b.keyPrefix+a)});return h(d,b),d}function oa(a,b,c){var d=this;a=j(a);var e=d.ready().then(function(){void 0===b&&(b=null);var c=b;return new wa(function(e,f){var g=d._dbInfo;g.serializer.serialize(b,function(b,d){if(d)f(d);else try{localStorage.setItem(g.keyPrefix+a,b),e(c)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||f(a),f(a)}})})});return h(e,c),e}function pa(a,b){if(b=k.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var c=this.config();a.name=a.name||c.name,a.storeName=a.storeName||c.storeName}var d,e=this;return d=a.name?new wa(function(b){b(a.storeName?da(a,e._defaultConfig):a.name+"/")}).then(function(a){for(var b=localStorage.length-1;b>=0;b--){var c=localStorage.key(b);0===c.indexOf(a)&&localStorage.removeItem(c)}}):wa.reject("Invalid arguments"),h(d,b),d}function qa(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function ra(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(Xa(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=b[c])}return arguments[0]}var sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ta=e();"undefined"==typeof Promise&&a(3);var ua,va,wa=Promise,xa="local-forage-detect-blob-support",ya=Object.prototype.toString,za="readonly",Aa="readwrite",Ba={_driver:"asyncStorage",_initStorage:B,_support:f(),iterate:D,getItem:C,setItem:E,removeItem:F,clear:G,length:H,key:I,keys:J,dropInstance:K},Ca="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Da="~~local_forage_type~",Ea=/^~~local_forage_type~([^~]+)~/,Fa="__lfsc__:",Ga=Fa.length,Ha="arbf",Ia="blob",Ja="si08",Ka="ui08",La="uic8",Ma="si16",Na="si32",Oa="ur16",Pa="ui32",Qa="fl32",Ra="fl64",Sa=Ga+Ha.length,Ta=Object.prototype.toString,Ua={serialize:O,deserialize:P,stringToBuffer:M,bufferToString:N},Va={_driver:"webSQLStorage",_initStorage:R,_support:L(),iterate:U,getItem:T,setItem:W,removeItem:X,clear:Y,length:Z,key:$,keys:_,dropInstance:ba},Wa={_driver:"localStorageWrapper",_initStorage:ga,_support:ca(),iterate:ja,getItem:ia,setItem:oa,removeItem:na,clear:ha,length:ma,key:ka,keys:la,dropInstance:pa},Xa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},Ya={},Za={},$a={INDEXEDDB:Ba,WEBSQL:Va,LOCALSTORAGE:Wa},_a=[$a.INDEXEDDB._driver,$a.WEBSQL._driver,$a.LOCALSTORAGE._driver],ab=["dropInstance"],bb=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ab),cb={description:"",driver:_a.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},db=function(){function a(b){d(this,a);for(var c in $a)if($a.hasOwnProperty(c)){var e=$a[c],f=e._driver;this[c]=f,Ya[f]||this.defineDriver(e)}this._defaultConfig=ra({},cb),this._config=ra({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(a){if("object"===(void 0===a?"undefined":sa(a))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),"version"===b&&"number"!=typeof a[b])return new Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,c){var d=new wa(function(b,c){try{var d=a._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(e);for(var f=bb.concat("_initStorage"),g=0,i=f.length;g<i;g++){var j=f[g];if((ab.indexOf(j)<0||a[j])&&"function"!=typeof a[j])return void c(e)}(function(){for(var b=function(a){return function(){var b=new Error("Method "+a+" is not implemented by the current driver"),c=wa.reject(b);return h(c,arguments[arguments.length-1]),c}},c=0,d=ab.length;c<d;c++){var e=ab[c];a[e]||(a[e]=b(e))}})();var k=function(c){Ya[d]&&console.info("Redefining LocalForage driver: "+d),Ya[d]=a,Za[d]=c,b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(k,c):k(!!a._support):k(!0)}catch(a){c(a)}});return i(d,b,c),d},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,c){var d=Ya[a]?wa.resolve(Ya[a]):wa.reject(new Error("Driver not found."));return i(d,b,c),d},a.prototype.getSerializer=function(a){var b=wa.resolve(Ua);return i(b,a),b},a.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===b._ready&&(b._ready=b._initDriver()),b._ready});return i(c,a,a),c},a.prototype.setDriver=function(a,b,c){function d(){g._config.driver=g.driver()}function e(a){return g._extend(a),d(),g._ready=g._initStorage(g._config),g._ready}function f(a){return function(){function b(){for(;c<a.length;){var f=a[c];return c++,g._dbInfo=null,g._ready=null,g.getDriver(f).then(e).catch(b)}d();var h=new Error("No available storage method found.");return g._driverSet=wa.reject(h),g._driverSet}var c=0;return b()}}var g=this;Xa(a)||(a=[a]);var h=this._getSupportedDrivers(a),j=null!==this._driverSet?this._driverSet.catch(function(){return wa.resolve()}):wa.resolve();return this._driverSet=j.then(function(){var a=h[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(function(a){g._driver=a._driver,d(),g._wrapLibraryMethodsWithReady(),g._initDriver=f(h)})}).catch(function(){d();var a=new Error("No available storage method found.");return g._driverSet=wa.reject(a),g._driverSet}),i(this._driverSet,b,c),this._driverSet},a.prototype.supports=function(a){return!!Za[a]},a.prototype._extend=function(a){ra(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];this.supports(e)&&b.push(e)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=bb.length;a<b;a++)qa(this,bb[a])},a.prototype.createInstance=function(b){return new a(b)},a}(),eb=new db;b.exports=eb},{3:3}]},{},[4])(4)});var slippymap=slippymap||{};slippymap.crosshairs=(function(){var latlon=true;var self={'init':function(map){var container=map.getContainer();var id=container.id;var draw=function(){self.draw_crosshairs(id);};window.onresize=draw;var coords=function(){self.draw_coords(map);};map.on('move',coords);map.on('dragend',coords);map.on('zoomend',coords);draw();coords();},'draw_coords':function(map){var coords=document.getElementById("slippymap-coords");if(!coords){var coords=document.createElement("div");coords.setAttribute("id","slippymap-coords");var container=map.getContainer();var container_el=document.getElementById(container.id);container_el.parentNode.insertBefore(coords,container_el.nextSibling);}
coords.onclick=function(){latlon=(latlon)?false:true;self.draw_coords(map);return;};var pos=map.getCenter();var lat=pos['lat'];var lon=pos['lng'];var zoom=map.getZoom();var ll=undefined;var title=undefined;if(latlon){ll=lat.toFixed(6)+", "+lon.toFixed(6)+" #"+zoom.toFixed(2);title="coordinates are displayed as latitude,longitude – click to toggle";}
else{ll=lon.toFixed(6)+", "+lat.toFixed(6)+" #"+zoom;title="coordinates are displayed as longitude,latitude – click to toggle";}
coords.setAttribute("title",title);coords.innerText=ll;},'draw_crosshairs':function(id){var m=document.getElementById(id);if(!m){return false;}
var container=m.getBoundingClientRect();var height=container.height;var width=container.width;var crosshair_y=(height/2)-8;var crosshair_x=(width/2);var data_url='"data:image/gif;base64,R0lGODlhEwATAKEBAAAAAP///////////'+
'yH5BAEKAAIALAAAAAATABMAAAIwlI+pGhALRXuRuWopPnOj7hngEpRm6Z'+
'ymAbTuC7eiitJlNHr5tmN99cNdQpIhsVIAADs="';var style=[];style.push("position:absolute");style.push("top:"+crosshair_y+"px");style.push("height:19px");style.push("width:19px");style.push("left:"+crosshair_x+"px");style.push("margin-left:-8px;");style.push("display:block");style.push("background-position: center center");style.push("background-repeat: no-repeat");style.push("background: url("+data_url+")");style.push("z-index:10000");style=style.join(";");var crosshairs=document.getElementById("slippymap-crosshairs");if(!crosshairs){crosshairs=document.createElement("div");crosshairs.setAttribute("id","slippymap-crosshairs");m.appendChild(crosshairs);}
crosshairs.style.cssText=style;return true;},};return self;})();window.addEventListener("load",function load(event){whosonfirst.browser.alt.init();});var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.alt=(function(){var map;var self={'init':function(){self.init_endpoints();self.init_map();self.init_properties();},'init_endpoints':function(){var body=document.body;var root=body.getAttribute("data-whosonfirst-uri-endpoint");if(root){whosonfirst.uri.endpoint(root);}},'init_names':function(){if(typeof(whosonfirst.namify)=='object'){whosonfirst.namify.namify_whosonfirst();}},'init_map':function(){map=whosonfirst.browser.common.init_map();},'init_properties':function(){whosonfirst.browser.common.init_properties();},}
return self;})();var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.api=(function(){var self={'do':function(http_method,rel_url,body){return new Promise((resolve,reject)=>{var abs_url=self.abs_url(rel_url);var onload=function(){if(this.status>=300){reject(this.responseText);return;}
var rsp;try{rsp=JSON.parse(this.responseText);}catch(err){console.log("ERR",abs_url,err);reject(err);return false;}
resolve(rsp);};var onprogress=function(rsp){};var onfailed=function(rsp){reject("Connection failed "+rsp);};var onabort=function(rsp){reject("Connection aborted "+rsp);};var req=new XMLHttpRequest();req.withCredentials=true;req.addEventListener("load",onload);req.addEventListener("progress",onprogress);req.addEventListener("error",onfailed);req.addEventListener("abort",onabort);req.open(http_method,abs_url,true);var enc_body=JSON.stringify(body);req.send(enc_body);});},'abs_url':function(rel_url){return rel_url;},};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.common=(function(){var map;var self={'init_map':function(){var map_svg=document.getElementById("map-svg");if(map_svg){var parent=map_svg.parentNode;if(parent){parent.removeChild(map_svg);}}
var geom=document.getElementById("whosonfirst-place");var lat=geom.getAttribute("data-latitude");var lon=geom.getAttribute("data-longitude");var centroid_geom={"type":"Point","coordinates":[lon,lat]};var centroid_props={};var centroid={"type":"Feature","geometry":centroid_geom,"properties":centroid_props};var minlat=geom.getAttribute("data-min-latitude");var minlon=geom.getAttribute("data-min-longitude");var maxlat=geom.getAttribute("data-max-latitude");var maxlon=geom.getAttribute("data-max-longitude");minlat=parseFloat(minlat);minlon=parseFloat(minlon);maxlat=parseFloat(maxlat);maxlon=parseFloat(maxlon);var sw=[minlat,minlon];var ne=[maxlat,maxlon];var bounds=[sw,ne];var map_el=document.getElementById("map");if(!map_el){console.log("Missing map element");return;}
var map_args={};map=whosonfirst.browser.maps.getMap(map_el,map_args);if(!map){console.log("Failed to get map");return false;}
if((minlat==maxlat)&&(minlon==maxlon)){map.setView(sw,15);}
else{var fit_opts={padding:[50,50]};map.fitBounds(bounds,fit_opts);}
return map;},'init_properties':function(){var place=document.getElementById("whosonfirst-place");var id=place.getAttribute("data-whosonfirst-id");var is_alt=place.getAttribute("data-whosonfirst-is-alternate");var src=place.getAttribute("data-whosonfirst-alt-source");var func=place.getAttribute("data-whosonfirst-alt-function");var uri_args={'alt':is_alt,'source':src,'function':func,'extras':[],};var data_url=whosonfirst.uri.id2abspath(id,uri_args)
console.log("FETCH",data_url);var on_success=function(feature){var geom=document.getElementById("whosonfirst-place");if(map){var lat=geom.getAttribute("data-latitude");var lon=geom.getAttribute("data-longitude");var centroid_geom={"type":"Point","coordinates":[lon,lat]};var centroid_props={};var centroid={"type":"Feature","geometry":centroid_geom,"properties":centroid_props};var feature_style=whosonfirst.leaflet.styles.polygon();var centroid_style=whosonfirst.leaflet.styles.centroid();var centroid_handler=whosonfirst.leaflet.handlers.centroid(centroid_style);if(feature["geometry"]["type"]=="Point"){whosonfirst.leaflet.utils.draw_point(map,feature,feature_style,centroid_handler);}
else if(feature["geometry"]["type"]=="MultiPoint"){whosonfirst.leaflet.utils.draw_point(map,feature,feature_style,centroid_handler);}
else{whosonfirst.leaflet.utils.draw_feature(map,feature,feature_style);}
whosonfirst.leaflet.utils.draw_point(map,centroid,centroid_style,centroid_handler);whosonfirst.leaflet.utils.fit_map(map,feature);}
var props=feature["properties"];var props_str=JSON.stringify(props,null,"\t");var props_raw=document.createElement("pre");props_raw.appendChild(document.createTextNode(props_str));var raw_el=document.getElementById("whosonfirst-properties-raw");var pretty_el=document.getElementById("whosonfirst-properties-pretty");var button_raw=document.createElement("button");button_raw.setAttribute("class","raw-pretty");button_raw.appendChild(document.createTextNode("show pretty"));button_raw.onclick=function(){raw_el.style.display="none";pretty_el.style.display="block";};var button_pretty=document.createElement("button");button_pretty.setAttribute("class","raw-pretty");button_pretty.appendChild(document.createTextNode("show raw"));button_pretty.onclick=function(){pretty_el.style.display="none";raw_el.style.display="block";};try{var props_pretty=whosonfirst.properties.render(props);if(props_pretty){raw_el.style.display="none";raw_el.appendChild(button_raw);raw_el.appendChild(props_raw);pretty_el.appendChild(button_pretty);pretty_el.appendChild(props_pretty);}
else{throw "Failed to generate pretty properties";}}
catch(e){raw_el.appendChild(button_raw);raw_el.appendChild(props_raw);console.log("PRETTY","ERR",e);}
var wof_el=document.getElementById("whosonfirst-wof");var wof_props={};for(k in props){var parts=k.split(":");if(parts[0]!="wof"){continue;}
var label=parts[1];wof_props[k]=props[k];}
var pretty=whosonfirst.properties.render(wof_props);var details=pretty.getElementsByTagName("details");var details_count=details.length;for(var i=0;i<details_count;i++){var d=details[i];d.setAttribute("open","true");}
wof_el.appendChild(pretty);self.init_names();};var on_error=function(rsp){console.log("ERROR",rsp);var centroid_layer=L.geoJSON(centroid);centroid_layer.addTo(map);};whosonfirst.net.fetch(data_url,on_success,on_error);}};return self;})();window.addEventListener("load",function load(event){var wasm_uri=whosonfirst.browser.uris.forCustomLabel("validate_wasm");var custom_wasm_uri=whosonfirst.browser.uris.forCustomLabel("custom_validate_wasm");sfomuseum.wasm.fetch(wasm_uri).then(rsp=>{if(!custom_wasm_uri){whosonfirst.browser.create.init();return;}
sfomuseum.wasm.fetch(custom_wasm_uri).then(rsp=>{whosonfirst.browser.create.init();return;}).catch(err=>{console.log("Failed to initialize custom validation code",err);});}).catch(err=>{console.log("Failed to initialize validation code",err);reject(err);});});var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.create=(function(){var map;var self={'init':function(){self.init_endpoints();self.init_map();self.init_controls();},'init_endpoints':function(){var body=document.body;var root=body.getAttribute("data-whosonfirst-uri-endpoint");if(root){whosonfirst.uri.endpoint(root);}},'init_map':function(){var map_el=document.getElementById("map");if(!map_el){whosonfirst.browser.feedback.emit("Missing 'map' element");return false}
L.PM.setOptIn(true);var map_args={pmIgnore:false,};map=whosonfirst.browser.maps.getMap(map_el,map_args);var geojson_pane_name="geometry"
var geojson_pane=map.createPane(geojson_pane_name);geojson_pane.style.zIndex=8000;var on_update=function(){var feature_group=map.pm.getGeomanLayers(true);var feature_collection=feature_group.toGeoJSON();};map.pm.setGlobalOptions({'panes':{vertexPane:geojson_pane_name,layerPane:geojson_pane_name,markerPane:geojson_pane_name,},markerStyle:{draggle:true,icon:whosonfirst.browser.leaflet.markerIcon(),pane:geojson_pane_name,}});map.on('pm:create',(e)=>{e.layer.options.pmIgnore=false;L.PM.reInitLayer(e.layer);});map.on("pm:drawend",function(e){console.log("draw end");on_update();});map.on('pm:remove',function(e){console.log("remove");on_update();});map.on('pm:globaleditmodetoggled',(e)=>{console.log("remove");on_update();});map.pm.addControls({position:'topleft',});},'init_controls':function(){self.init_property_controls();self.init_save_controls();},'init_property_controls':function(){var optional_els=document.getElementsByClassName("wof-property-optional");var count_optional=optional_els.length;for(var i=0;i<count_optional;i++){self.add_remove_button(optional_els[i]);}
var add_button=document.getElementById("add-property");if(!add_button){console.log("Missing 'add-property' element.");return false;};add_button.onclick=function(){var form=document.getElementById("wof-properties-form");if(!form){whosonfirst.browser.feedback.emit("Failed to locate 'wof-properties-form' element.");return false;}
var id=prompt("Property name");if(!id){return false;}
var existing_el=document.getElementById(id);if(existing_el){alert("Property with this name already exists");return false;}
var property_type="string";var new_el=self.create_property_el(id,property_type);form.appendChild(new_el);return false;};},'create_property_el':function(id,property_type){var ta=document.createElement("textarea");ta.setAttribute("class","form-control-plaintext wof-property wof-property-"+property_type);ta.setAttribute("id",id);var l=document.createElement("label");l.setAttribute("for",id);l.appendChild(document.createTextNode(id));var el=document.createElement("div");el.setAttribute("class","col-auto wof-property-block");el.setAttribute("id",id+"-wrapper");el.appendChild(l);el.appendChild(ta);self.add_remove_button(el);return el;},'add_remove_button':function(el){var labels=el.getElementsByTagName("label");var count=labels.length;if(count!=1){console.log("Invalid count for labels",count);}
var l=labels[0];var id=el.getAttribute("id");id=id.replace("-wrapper","");var remove=document.createElement("span");remove.setAttribute("class","remove-property");remove.setAttribute("data-property",id);remove.appendChild(document.createTextNode("[x]"));remove.onclick=function(e){var this_el=e.target;var prop=this_el.getAttribute("data-property");var wrapper=document.getElementById(prop+"-wrapper");if(!wrapper){return false;}
if(confirm("Are you sure you want to remove this property?")){wrapper.remove();}
return false;};l.appendChild(remove);},'init_save_controls':function(){var save_button=document.getElementById("save");save_button.onclick=function(){var props={};var inputs=document.getElementsByClassName("wof-property");var count=inputs.length;for(var i=0;i<count;i++){var el=inputs[i];var el_class=el.getAttribute("class");var k=el.getAttribute("id");var v=el.value;if(v==""){continue;}
if((v.startsWith("["))||(v.startsWith("{"))){try{v=JSON.parse(v);}catch(err){whosonfirst.browser.feedback.emit("Failed to parse '"+k+"="+v+"' property, "+err);return false;}}
props[k]=v;}
try{var feature_group=map.pm.getGeomanLayers(true);var feature_collection=feature_group.toGeoJSON();var count=feature_collection.features.length;var geom;switch(count){case 0:whosonfirst.browser.feedback.emit("Missing geometry");return false;break;case 1:geom=feature_collection.features[0].geometry;break;default:_geoms=[];for(var i=0;i<count;i++){_geoms.push(feature_collection.features[i].geometry);}
geom={'type':'GeometryCollection','geometries':_geoms,};break;}
var feature={'type':'Feature','properties':props,'geometry':geom,};var create_uri=whosonfirst.browser.uris.forLabel("create_feature_api");var str_f=JSON.stringify(feature);var do_create=function(){whosonfirst.browser.api.do("PUT",create_uri,feature).then((data)=>{var props=data["properties"];var id=props["wof:id"];whosonfirst.browser.feedback.emit("New feature created with ID "+id);save_button.removeAttribute("disabled");}).catch((err)=>{whosonfirst.browser.feedback.emit("Failed to create new feature",err);save_button.removeAttribute("disabled");});whosonfirst.browser.feedback.emit("Creating new feature...");save_button.setAttribute("disabled","disabled");};validate_feature(str_f).then(rsp=>{if(typeof(whosonfirst_validate_feature_custom)!="function"){do_create();return;}
whosonfirst_validate_feature_custom(str_f).then(rsp=>{do_create();}).catch(err=>{whosonfirst.browser.feedback.emit("Document failed custom validation:",err);})}).catch(err=>{whosonfirst.browser.feedback.emit("Document failed to validate:",err);console.log("Document failed to validate",err,feature);});}catch(err){whosonfirst.browser.feedback.emit("Unable to prepare data to create new feature",err);}
return false;};},}
return self;})();var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.feedback=(function(){var self={emit:function(){var msg=Array.from(arguments).join(" ");var dt=new Date();console.log(dt.toUTCString(),msg);var feedback_el=document.getElementById("feedback");if(feedback_el){feedback.innerText=msg;}},clear:function(){var feedback_el=document.getElementById("feedback");if(feedback_el){feedback_el.innerHTML='';}}};return self;})();window.addEventListener("load",function load(event){whosonfirst.browser.geometry.init();});var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.geometry=(function(){var map;var events={};var self={'init':function(){self.init_endpoints();self.init_geometry();self.init_controls();},'init_endpoints':function(){var body=document.body;var root=body.getAttribute("data-whosonfirst-uri-endpoint");if(root){whosonfirst.uri.endpoint(root);}},'init_geometry':function(){var edit_el=document.getElementById("edit-geometry");if(!edit_el){whosonfirst.browser.feedback.emit("Missing 'edit-geometry' element");return false;}
var wof_id=edit_el.getAttribute("data-whosonfirst-id");if(!wof_id){whosonfirst.browser.feedback.emit("Missing 'data-whosonfirst-id' attribute");return;}
var map_el=document.getElementById("map");if(!map_el){whosonfirst.browser.feedback.emit("Missing 'map' element");return false}
L.PM.setOptIn(true);var map_args={pmIgnore:false,};map=whosonfirst.browser.maps.getMap(map_el,map_args);var geojson_pane_name="geometry"
var geojson_pane=map.createPane(geojson_pane_name);geojson_pane.style.zIndex=8000;var data_url=whosonfirst.uri.id2abspath(wof_id)
var on_success=function(feature){whosonfirst.browser.feedback.clear();var props=feature.properties;var name=props["wof:name"];var id=props["wof:id"];var name_el=document.getElementById("wof:name");var id_el=document.getElementById("wof:id");if(name_el){name_el.innerText=name;}
if(id_el){id_el.innerText=id;}
var bbox=whosonfirst.geojson.derive_bbox(feature);var bounds=[[bbox[1],bbox[0]],[bbox[3],bbox[2]],];switch(map_el.getAttribute("data-map-provider")){case "protomaps":break;default:map.fitBounds(bounds);break;}
if(!map.pm){var layer=L.geoJSON(feature);layer.addTo(map);whosonfirst.browser.feedback.emit("Missing map.pm");return;}
var on_update=function(){var feature_group=map.pm.getGeomanLayers(true);var feature_collection=feature_group.toGeoJSON();var geojson_el=document.getElementById("geojson");if(!geojson_el){return;}
var enc_featurecollection=JSON.stringify(feature_collection," ",2);geojson_el.innerText=enc_feature_collection;};map.pm.setGlobalOptions({'panes':{vertexPane:geojson_pane_name,layerPane:geojson_pane_name,markerPane:geojson_pane_name,}});map.pm.addControls({position:'topleft',});map.on('pm:create',(e)=>{e.layer.options.pmIgnore=false;L.PM.reInitLayer(e.layer);});map.on("pm:drawend",function(e){console.log("draw end");on_update();});map.on('pm:remove',function(e){console.log("remove");on_update();});map.on('pm:globaleditmodetoggled',(e)=>{console.log("remove");on_update();});const geojson_layer=L.geoJson(feature,{pointToLayer:(feature,latlng)=>{if(feature.properties.customGeometry){return new L.Circle(latlng,{pane:geojson_pane_name,radius:feature.properties.customGeometry.radius,pmIgnore:false,});}else{return new L.Marker(latlng,{icon:whosonfirst.browser.leaflet.markerIcon(),pane:geojson_pane_name,pmIgnore:false,});}},pane:geojson_pane_name,pmIgnore:false,});geojson_layer.addTo(map);if(events["load"]){var count=events["load"].length;for(var i=0;i<count;i++){events["load"][i](feature);}}};var on_error=function(err){whosonfirst.browser.feedback.emit("Failed to load record",err);};whosonfirst.browser.feedback.emit("Loading record");whosonfirst.net.fetch(data_url,on_success,on_error);},'init_controls':function(){self.init_save_control();},'init_save_control':function(){var save_button=document.getElementById("save");save_button.onclick=function(){var edit_el=document.getElementById("edit-geometry");if(!edit_el){whosonfirst.browser.feedback.emit("Missing 'edit-geometry' element");return false;}
var wof_id=edit_el.getAttribute("data-whosonfirst-id");if(!wof_id){whosonfirst.browser.feedback.emit("Missing 'data-whosonfirst-id' attribute");return;}
try{var feature_group=map.pm.getGeomanLayers(true);var feature_collection=feature_group.toGeoJSON();var count=feature_collection.features.length;var geom;switch(count){case 0:whosonfirst.browser.feedback.emit("Missing geometry");return false;break;case 1:geom=feature_collection.features[0].geometry;break;default:_geoms=[];for(var i=0;i<count;i++){_geoms.push(feature_collection.features[i].geometry);}
geom={'type':'GeometryCollection','geometries':_geoms,};break;}
var feature={'type':'Feature','properties':{},'geometry':geom,};var edit_uri=whosonfirst.browser.uris.forLabel("edit_geometry_api")+wof_id;whosonfirst.browser.api.do("POST",edit_uri,feature).then((data)=>{whosonfirst.browser.feedback.emit("Geometry has been successfully updated");save_button.removeAttribute("disabled");}).catch((err)=>{whosonfirst.browser.feedback.emit("Failed to update geometry",err);save_button.removeAttribute("disabled");});whosonfirst.browser.feedback.emit("Updating geometry...");save_button.setAttribute("disabled","disabled");}catch(err){whosonfirst.browser.feedback.emit("Failed to parse record before submitting update",err);}
return false;};},on:function(target,func){var addEvent=function(target,func){funcs=events[target];if(!funcs){funcs=[];}
funcs.push(func)
events[target]=funcs;};switch(target){case 'load':addEvent(target,func);break;default:console.log("Unsupported target",target);break;}},}
return self;})();window.addEventListener("load",function load(event){whosonfirst.browser.id.init();});var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.id=(function(){var map;var self={'init':function(){self.init_endpoints();self.init_map();self.init_properties();self.init_names();},'init_endpoints':function(){var body=document.body;var root=body.getAttribute("data-whosonfirst-uri-endpoint");if(root){whosonfirst.uri.endpoint(root);}},'init_names':function(){if(typeof(whosonfirst.namify)=='object'){whosonfirst.namify.namify_whosonfirst();}},'init_map':function(){map=whosonfirst.browser.common.init_map();},'init_properties':function(){var place=document.getElementById("whosonfirst-place");var id=place.getAttribute("data-whosonfirst-id");var data_url=whosonfirst.uri.id2abspath(id)
console.log("FETCH",data_url);var on_success=function(feature){var geom=document.getElementById("whosonfirst-place");if(map){var lat=geom.getAttribute("data-latitude");var lon=geom.getAttribute("data-longitude");var centroid_geom={"type":"Point","coordinates":[lon,lat]};var centroid_props={};var centroid={"type":"Feature","geometry":centroid_geom,"properties":centroid_props};var feature_style=whosonfirst.leaflet.styles.polygon();var centroid_style=whosonfirst.leaflet.styles.centroid();var centroid_handler=whosonfirst.leaflet.handlers.centroid(centroid_style);if(feature["geometry"]["type"]=="Point"){whosonfirst.leaflet.utils.draw_point(map,feature,feature_style,centroid_handler);}
else if(feature["geometry"]["type"]=="MultiPoint"){whosonfirst.leaflet.utils.draw_point(map,feature,feature_style,centroid_handler);}
else{whosonfirst.leaflet.utils.draw_feature(map,feature,feature_style);}
whosonfirst.leaflet.utils.draw_point(map,centroid,centroid_style,centroid_handler);whosonfirst.leaflet.utils.fit_map(map,feature);}
var props=feature["properties"];var props_str=JSON.stringify(props,null,"\t");var props_raw=document.createElement("pre");props_raw.appendChild(document.createTextNode(props_str));var raw_el=document.getElementById("whosonfirst-properties-raw");var pretty_el=document.getElementById("whosonfirst-properties-pretty");var button_raw=document.createElement("button");button_raw.setAttribute("class","raw-pretty");button_raw.appendChild(document.createTextNode("show pretty"));button_raw.onclick=function(){raw_el.style.display="none";pretty_el.style.display="block";};var button_pretty=document.createElement("button");button_pretty.setAttribute("class","raw-pretty");button_pretty.appendChild(document.createTextNode("show raw"));button_pretty.onclick=function(){pretty_el.style.display="none";raw_el.style.display="block";};try{var props_pretty=whosonfirst.properties.render(props);if(props_pretty){raw_el.style.display="none";raw_el.appendChild(button_raw);raw_el.appendChild(props_raw);pretty_el.appendChild(button_pretty);pretty_el.appendChild(props_pretty);}
else{throw "Failed to generate pretty properties";}}
catch(e){raw_el.appendChild(button_raw);raw_el.appendChild(props_raw);console.log("PRETTY","ERR",e);}
var wof_el=document.getElementById("whosonfirst-wof");var src_el=document.getElementById("whosonfirst-src");var wof_props={};var src_props={};for(k in props){var parts=k.split(":");var ns=parts[0];var label=parts[1];switch(ns){case "src":src_props[k]=props[k];break;case "wof":wof_props[k]=props[k];break;default:continue;}}
var append=function(el,props){var pretty=whosonfirst.properties.render(props);el.appendChild(pretty);var details=pretty.getElementsByTagName("details");var details_count=details.length;for(var i=0;i<details_count;i++){var d=details[i];d.setAttribute("open","true");}};append(src_el,src_props);append(wof_el,wof_props);self.init_names();};var on_error=function(rsp){console.log("ERROR",rsp);var centroid_layer=L.geoJSON(centroid);centroid_layer.addTo(map);};whosonfirst.net.fetch(data_url,on_success,on_error);}}
return self;})();var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.leaflet=(function(){var self={markerIcon:function(){const marker_svg="iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=";const retina_svg="iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==";const shadow_svg="iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";var icon=L.icon({iconUrl:'data:image/png;base64,'+marker_svg,iconRetinaUrl:'data:image/png;base64,'+retina_svg,shadowUrl:'data:image/png;base64,'+shadow_svg,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});return icon}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.browser=whosonfirst.browser||{};whosonfirst.browser.maps=(function(){var attribution;var self={'getMap':function(map_el,args){return aaronland.maps.getMap(map_el,args);},'getAttribution':function(){return attribution;},};return self;})();var whosonfirst=whosonfirst||{};whosonfirst=whosonfirst||{};whosonfirst.cache=(function(){var default_cache_ttl=30000;var local_cache={};var self={'init':function(){},'get':function(key,on_hit,on_miss,args){var fq_key=self.prep_key(key,args);var cache_ttl=default_cache_ttl;if(args["cache_ttl"]){cache_ttl=args["cache_ttl"];}
var handle_rsp=function(rsp){if(!rsp){on_miss();return;}
var data=rsp['data'];if(!data){on_miss();return;}
var dt=new Date();var ts=dt.getTime();var then=rsp['created'];var diff=ts-then;if(diff>cache_ttl){self.unset(key,args);on_miss();return;}
on_hit(data);};if(typeof(localforage)=='object'){localforage.getItem(fq_key,function(err,rsp){if(err){on_miss();}
handle_rsp(rsp);});}
else{var rsp=local_cache[key];handle_rsp(rsp);}
return true;},'set':function(key,value,args){var fq_key=self.prep_key(key,args);var dt=new Date();var ts=dt.getTime();var wrapper={'data':value,'created':ts};if(typeof(localforage)=='object'){localforage.setItem(fq_key,wrapper);}
else{local_cache[fq_key]=wrapper;}
return true;},'unset':function(key,args){var fq_key=self.prep_key(key,args);if(typeof(localforage)!='object'){localforage.removeItem(fq_key);}
else{delete(local_cache[fq_key]);}
return true;},'prep_key':function(key,args){if(!args){args={};}
var suffix=args["suffix"];if(!suffix){suffix=location.host;}
return key+"#"+suffix;}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.geojson=(function(){var self={'derive_bbox':function(feature){if(feature['bbox']){return feature['bbox'];}
if(feature['type']=='FeatureCollection'){var features=feature['features'];var count=features.length;var swlat=undefined;var swlon=undefined;var nelat=undefined;var nelon=undefined;for(var i=0;i<count;i++){var bbox=self.derive_bbox(features[i]);var _swlat=bbox[0];var _swlon=bbox[1];var _nelat=bbox[2];var _nelon=bbox[3];if((!swlat)||(_swlat<swlat)){swlat=_swlat;}
if((!swlon)||(_swlon<swlon)){swlon=_swlon;}
if((!nelat)||(_nelat>nelat)){nelat=_nelat;}
if((!nelon)||(_nelon>nelon)){nelon=_nelon;}}
return[swlat,swlon,nelat,nelon];}
else if(feature['type']=='Feature'){var geom=feature['geometry'];var coords=geom.coordinates;var lats=[],lngs=[];for(var i=0;i<coords[0].length;i++){lats.push(coords[0][i][1]);lngs.push(coords[0][i][0]);}
var minlat=Math.min.apply(null,lats),maxlat=Math.max.apply(null,lats);var minlng=Math.min.apply(null,lngs),maxlng=Math.max.apply(null,lngs);return[minlat,minlng,maxlat,maxlng];}
else{}}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.leaflet=whosonfirst.leaflet||{};whosonfirst.leaflet.handlers=(function(){var self={'centroid':function(style){return function(feature,latlon){var m=L.circleMarker(latlon,style);try{var props=feature['properties'];m.bindTooltip(props["wof:name"]).openTooltip();}
catch(e){console.log("failed to bind label because "+e);}
return m;};},};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.leaflet=whosonfirst.leaflet||{};whosonfirst.leaflet.styles=(function(){var self={'bbox':function(){return{"color":"#000000","weight":.5,"opacity":1,"fillColor":"#000000","fillOpacity":.4,};},'centroid':function(){return{"color":"#fff","weight":3,"opacity":1,"radius":10,"fillColor":"#ff0099","fillOpacity":0.8};},'math_centroid':function(){return{"color":"#fff","weight":2,"opacity":1,"radius":6,"fillColor":"#ff7800","fillOpacity":0.8};},'geom_centroid':function(){return{"color":"#fff","weight":3,"opacity":1,"radius":10,"fillColor":"#32cd32","fillOpacity":0.8};},'search_centroid':function(){return{"color":"#000","weight":2,"opacity":1,"radius":6,"fillColor":"#0BBDFF","fillOpacity":1};},'breach_polygon':function(){return{"color":"#ffff00","weight":1.5,"dashArray":"5, 5","opacity":1,"fillColor":"#002EA7","fillOpacity":0.1};},'polygon':function(){return{"color":"#ff0066","weight":2,"opacity":1,"fillColor":"#ff69b4","fillOpacity":0.6};},'parent_polygon':function(){return{"color":"#000","weight":1,"opacity":1,"fillColor":"#00308F","fillOpacity":0.5};}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.leaflet=whosonfirst.leaflet||{};whosonfirst.leaflet.utils=(function(){var self={'draw_feature':function(map,feature,style,handler){if(feature["geometry"]["type"]=="Point"){return self.draw_point(map,feature,style,handler);}
if(feature["geometry"]["type"]=="MultiPoint"){return self.draw_point(map,feature,style,handler);}
self.draw_polygon(map,feature,style);},'draw_point':function(map,feature,style,handler){if(!handler){return function(feature,latlon){return L.circle(latlon,style);}}
var layer=L.geoJson(feature,{'style':style,'pointToLayer':handler,});layer.addTo(map);return layer;},'draw_polygon':function(map,feature,style){var layer=L.geoJson(feature,{'style':style});layer.addTo(map);return layer;},'draw_bbox':function(map,feature,style){if(typeof(whosonfirst.geojson)!='object'){console.log("MISSING whosonfirst.geojson library");return null;}
var bbox=whosonfirst.geojson.derive_bbox(feature);if(!bbox){console.log("no bounding box");return false;}
var bbox=feature['bbox'];var swlat=bbox[1];var swlon=bbox[0];var nelat=bbox[3];var nelon=bbox[2];var geom={'type':'Polygon','coordinates':[[[swlon,swlat],[swlon,nelat],[nelon,nelat],[nelon,swlat],[swlon,swlat],]]};var bbox_feature={'type':'Feature','geometry':geom}
return self.draw_polygon(map,bbox_feature,style);},'fit_map':function(map,feature,force){if(typeof(whosonfirst.geojson)!='object'){console.log("MISSING whosonfirst.geojson library");return null;}
var bbox=whosonfirst.geojson.derive_bbox(feature);if(!bbox){console.log("no bounding box");return false;}
if((bbox[1]==bbox[3])&&(bbox[2]==bbox[4])){map.setView([bbox[1],bbox[0]],14);return;}
var sw=[bbox[1],bbox[0]];var ne=[bbox[3],bbox[2]];var bounds=new L.LatLngBounds([sw,ne]);var current=map.getBounds();var redraw=true;if(!force){var redraw=false;if(bounds.getSouth()<=current.getSouth().toFixed(6)){redraw=true;}
else if(bounds.getWest()<=current.getWest().toFixed(6)){redraw=true;}
else if(bounds.getNorth()>=current.getNorth().toFixed(6)){redraw=true;}
else if(bounds.getEast()>=current.getEast().toFixed(6)){redraw=true;}
else{}}
if(redraw){var opts={'padding':[50,50]};map.fitBounds(bounds,opts);}}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst=whosonfirst||{};whosonfirst.namify=(function(){var cache_ttl=30000;var self={'init':function(){},'namify_whosonfirst':function(){var resolver=whosonfirst.uri.id2abspath;var els=document.getElementsByClassName("whosonfirst-namify");var count=els.length;for(var i=0;i<count;i++){self.namify_el(els[i],resolver);}},'namify_el':function(el,resolver){var wofid=el.getAttribute("data-whosonfirst-id");if(!wofid){return;}
var url=resolver(wofid);var on_hit=function(feature){self.apply_namification(el,feature);};var on_miss=function(){self.namify_el_from_source(url,el);};if(!self.cache_get(url,on_hit,on_miss)){self.namify_el_from_source(url,el);}},'namify_el_from_source':function(url,el){var on_fetch=function(feature){self.apply_namification(el,feature);self.cache_set(url,feature);};var on_fail=function(rsp){};whosonfirst.net.fetch(url,on_fetch,on_fail);},'apply_namification':function(el,feature){var props=feature['properties'];if(!props){props=feature;}
var label=props['wof:label'];if((!label)||(label=='')){var possible=['wof:name','wof:brand_name'];var count=possible.length;for(var i=0;i<count;i++){var k=possible[i];if(props[k]){label=props[k];break;}}}
el.innerHTML=label;},'cache_args':function(){return{'suffix':'whosonfirst.namify','ttl':cache_ttl,};},'cache_get':function(key,on_hit,on_miss){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();return whosonfirst.cache.get(key,on_hit,on_miss,args);},'cache_set':function(key,value){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();return whosonfirst.cache.set(key,value,args);},'cache_unset':function(key){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();return whosonfirst.cache.unset(key,args);}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.net=(function(){var default_cache_ttl=30000;var self={'encode_query':function(query){enc=new Array();for(var k in query){var v=query[k];v=encodeURIComponent(v);enc.push(k+"="+v);}
return enc.join("&");},'fetch':function(url,on_success,on_fail,args){if(typeof(args)=="undefined"){args={};}
var on_hit=function(data){if(on_success){on_success(data);}};var on_miss=function(){self.fetch_with_xhr(url,on_success,on_fail,args);};if(!self.cache_get(url,on_hit,on_miss,args)){self.fetch_with_xhr(url,on_success,on_fail,args);}},'fetch_with_xhr':function(url,on_success,on_fail,args){if(!args){args={};}
var req=new XMLHttpRequest();req.onload=function(){try{var data=JSON.parse(this.responseText);}
catch(e){if(on_fail){on_fail({url:url,args:args,xhr:req});}
return false;}
self.cache_set(url,data);if(on_success){on_success(data);}};try{if(args["cache-busting"]){var cb=Math.floor(Math.random()*1000000);var tmp=document.createElement("a");tmp.href=url;if(tmp.search){tmp.search+="&cb="+cb;}
else{tmp.search="?cb= "+cb;}
url=tmp.href;}
req.open("get",url,true);req.send();}
catch(e){if(on_fail){on_fail();}}},'cache_args':function(){return{'suffix':'whosonfirst.net','cache_ttl':default_cache_ttl,};},'cache_get':function(key,on_hit,on_miss,user_args){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();if(typeof(user_args)=='object'){for(k in user_args){args[k]=user_args[k];}}
return whosonfirst.cache.get(key,on_hit,on_miss,args);},'cache_set':function(key,value){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();return whosonfirst.cache.set(key,value,args);},'cache_unset':function(key){if(typeof(whosonfirst.cache)!='object'){return false;}
var args=self.cache_args();return whosonfirst.cache.unset(key,args);}};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.properties=(function(){var spelunker="http://spelunker.whosonfirst.org";var self={'render':function(props){var required=[whosonfirst.www,whosonfirst.render];for(var i in required){var dep=required[i];if(typeof(dep)!='object'){console.log("PROPERTIES","missing dependency");return null;}}
var possible_wof=['wof.belongsto','wof.involves','wof.parent_id','wof.children','wof.breaches','wof.supersedes','wof.superseded_by','wof.hierarchy.continent_id','wof.hierarchy.country_id','wof.hierarchy.macroregion_id','wof.hierarchy.region_id','wof.hierarchy.county_id','wof.hierarchy.localadmin_id','wof.hierarchy.borough_id','wof.hierarchy.locality_id','wof.hierarchy.macrohood_id','wof.hierarchy.neighbourhood_id','wof.hierarchy.microhood_id','wof.hierarchy.campus_id','wof.hierarchy.venue_id','wof.hierarchy.postalcode_id','wof.hierarchy.building_id','wof.hierarchy.concourse_id','wof.hierarchy.wing_id','_global_.continent_id','_global_.country_id','_global_.macroregion_id','_global_.region_id','_global_.county_id','_global_.localadmin_id','_global_.borough_id','_global_.locality_id','_global_.macrohood_id','_global_.neighbourhood_id','_global_.microhood_id','_global_.campus_id','_global_.venue_id'];var text_callbacks={'wof.id':whosonfirst.render.render_code,'wof.placetype':self.render_placetype,'wof.concordances.4sq:id':self.render_foursquare_id,'wof.concordances.companieshouse:number':self.render_companieshouse_number,'wof.concordances.gn:id':self.render_geonames_id,'wof.concordances.gp:id':self.render_woedb_id,'wof.concordances.woe:id':self.render_woedb_id,'wof.concordances.oa:id':self.render_ourairport_id,'wof.concordances.faa:code':self.render_faa_code,'wof.concordances.latimes:id':self.render_latimes_id,'wof.concordances.tgn:id':self.render_tgn_id,'wof.concordances.transitland:onestop_id':self.render_transitland_onestop_id,'wof.concordances.wd:id':self.render_wikidata_id,'wof.concordances.wk:page':self.render_wikipedia_page,'wof.lastmodified':whosonfirst.render.render_timestamp,'wof.megacity':self.render_megacity,'wof.repo':self.render_wof_repo,'wof.tags':self.render_wof_tags,'wof.name':self.render_wof_name,'sg.city':self.render_simplegeo_city,'sg.postcode':self.render_simplegeo_postcode,'sg.tags':self.render_simplegeo_tags,'sg.classifier':self.render_simplegeo_classifiers,'src.geom_alt':self.render_src_geom_alt,};var text_renderers=function(d,ctx){var test=ctx.replace(/\#\d+/,"")
if((possible_wof.indexOf(test)!=-1)&&(d>0)){return self.render_wof_id;}
else if(test.match(/^name-/)){return self.render_wof_name;}
else if(test.match(/^sg-classifiers-/)){return self.render_simplegeo_classifiers;}
else if(text_callbacks[test]){return text_callbacks[test];}
else{return null;}};var dict_mappings={'wof.concordances.4sq:id':'foursquare','wof.concordances.dbp:id':'dbpedia','wof.concordances.faa:code':'faa','wof.concordances.fb:id':'freebase','wof.concordances.fct:id':'factual','wof.concordances.gn:id':'geonames','wof.concordances.gp:id':'geoplanet','wof.concordances.icao:code':'icao','wof.concordances.iata:code':'iata','wof.concordances.latimes:id':'los angeles times','wof.concordances.loc:id':'library of congress','wof.concordances.nyt:id':'new york times','wof.concordances.oa:id':'ourairports','wof.concordances.qs:id':'quattroshapes','wof.concordances.transitland:onestop_id':'transitland','wof.concordances.wk:page':'wikipedia','wof.concordances.wd:id':'wikidata','wof.hierarchy.borough_id':'borough','wof.hierarchy.continent_id':'continent','wof.hierarchy.country_id':'country','wof.hierarchy.macroregion_id':'macro region','wof.hierarchy.region_id':'region','wof.hierarchy.campus_id':'campus','wof.hierarchy.county_id':'county','wof.hierarchy.intersection':'intersection','wof.hierarchy.localadmin_id':'local admin','wof.hierarchy.locality_id':'locality','wof.hierarchy.macrohood_id':'macro hood','wof.hierarchy.neighbourhood_id':'neighbourhood','wof.hierarchy.microhood_id':'micro hood','_global_.borough_id':'borough','_global_.continent_id':'continent','_global_.country_id':'country','_global_.macroregion_id':'macro region','_global_.region_id':'region','_global_.campus_id':'campus','_global_.county_id':'county','_global_.intersection':'intersection','_global_.localadmin_id':'local admin','_global_.locality_id':'locality','_global_.macrohood_id':'macro hood','_global_.neighbourhood_id':'neighbourhood','_global_.microhood_id':'micro hood',};var dict_renderers=function(d,ctx){if(dict_mappings[ctx]){return function(){return dict_mappings[ctx];};}
return null;};var text_exclusions=function(d,ctx){return function(){if(ctx.match(/^geom/)){return true;}
else if((ctx.match(/^edtf/))&&(d=="uuuu")){return true;}
else if(ctx=='wof.lastmodified'){return true;}
else if(ctx=='wof.geomhash'){return true;}
else if(ctx=='wof.id'){return true;}
else{return false;}};};whosonfirst.render.set_custom_renderers('text',text_renderers);whosonfirst.render.set_custom_renderers('dict',dict_renderers);whosonfirst.render.set_custom_exclusions('text',text_exclusions);var pretty=whosonfirst.render.render(props);return pretty;},'render_wof_id':function(d,ctx){var link="/id/"+encodeURIComponent(d)+"/";var el=whosonfirst.render.render_link(link,d,ctx);var text=el.children[0];text.setAttribute("data-value",whosonfirst.render.htmlspecialchars(d));text.setAttribute("data-whosonfirst-id",whosonfirst.render.htmlspecialchars(d));text.setAttribute("class","whosonfirst-namify props-uoc props-uoc-name props-uoc-name_"+whosonfirst.render.htmlspecialchars(d));return el;},'render_wof_repo':function(d,ctx){var root='https://github.com/whosonfirst-data/';if(d=='whosonfirst-data'){var root='https://github.com/whosonfirst/';}
var link=root+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_wof_placetype':function(d,ctx){var root=spelunker;var link=root+"placetypes/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_foursquare_id':function(d,ctx){var link="https://www.foursquare.com/v/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_geonames_id':function(d,ctx){var link="http://geonames.org/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_woedb_id':function(d,ctx){var link="https://woe.spum.org/id/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_wikipedia_page':function(d,ctx){d=decodeURI(d);var link="https://www.wikipedia.org/wiki/"+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_wikidata_id':function(d,ctx){var link="https://www.wikidata.org/wiki/"+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_transitland_onestop_id':function(d,ctx){var href="https://mapzen.com/mobility/explorer/#/stops?bbox=__BBOX__&onestop_id="+encodeURIComponent(d);var link=whosonfirst.render.render_link(href,d,ctx);link.onclick=function(e){try{var el=e.target;var parent=el.parentNode;var href=parent.getAttribute("href");var lat=document.getElementById("geom.latitude");var lon=document.getElementById("geom.longitude");lat=parseFloat(lat.innerText);lon=parseFloat(lon.innerText);var gp=new GeoPoint(lat,lon,false);var bounds=gp.boundingCoordinates(.5);var bbox=[bounds[0].longitude(),bounds[0].latitude(),bounds[1].longitude(),bounds[1].latitude()];bbox=bbox.join(",");bbox=encodeURIComponent(bbox);href=href.replace("__BBOX__",bbox);location.href=href;}
catch(e){console.log("Failed to generate Transitland / Mobility Explore URL, because "+e);}
return false;};return link;},'render_tgn_id':function(d,ctx){var link="http://vocab.getty.edu/tgn/"+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_ourairport_id':function(d,ctx){var link="http://ourairports.com/airports/"+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_faa_code':function(d,ctx){var link="http://www.fly.faa.gov/flyfaa/flyfaaindex.jsp?ARPT="+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_companieshouse_number':function(d,ctx){var link="http://data.companieshouse.gov.uk/doc/company/"+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_latimes_id':function(d,ctx){var link="http://maps.latimes.com/neighborhoods/neighborhood/"+encodeURIComponent(d);var el=whosonfirst.render.render_link(link,d,ctx);el.onclick=function(e){try{var el=e.target;var parent=el.parentNode;var href=parent.getAttribute("href");var pt=document.getElementById("wof.placetype");pt=pt.innerText;if(pt=="macrohood"){href=href.replace("neighborhoods/neighborhood","neighborhoods/region");}
location.href=href;return false;}
catch(e){console.log("failed to generate latimes:id link, because "+e);}};return el;},'render_megacity':function(d,ctx){var root=spelunker;var link=root+"megacities/";return whosonfirst.render.render_link(link,"HOW BIG WOW MEGA SO CITY",ctx);},'render_wof_tags':function(d,ctx){var root=spelunker;var link=root+"tags/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_wof_name':function(d,ctx){var root=spelunker;var link=root+"search/?q="+encodeURIComponent(d);return whosonfirst.render.render_link(link,d,ctx);},'render_simplegeo_city':function(d,ctx){var root=spelunker;var link=root+"search/?q="+encodeURIComponent(d)+"&placetype=locality";return whosonfirst.render.render_link(link,d,ctx);},'render_simplegeo_postcode':function(d,ctx){var root=spelunker;var link=root+"postalcodes/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_simplegeo_classifiers':function(d,ctx){var root=spelunker;var link=root+"categories/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_simplegeo_tags':function(d,ctx){var root=spelunker;var link=root+"tags/"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},'render_src_geom_alt':function(d,ctx){var root=location.href;root=root.replace(/^alt-/,"");root=root.replace(/\/$/,"");var link=root+"-alt-"+encodeURIComponent(d)+"/";return whosonfirst.render.render_link(link,d,ctx);},};return self;})();var whosonfirst=whosonfirst||{};whosonfirst.render=(function(){var _custom_renderers={'dict':function(d,ctx){return null;},'text':function(d,ctx){return null;},};var _exclusions={'text':function(d,ctx){return null;},};var self={'enabled':function(bool){if(typeof(bool)!="undefined"){if(bool){_enabled=true;}else{_enabled=false;}}
return _enabled;},'set_custom_renderers':function(t,r){if(!_custom_renderers[t]){return;}
if(!r){return;}
_custom_renderers[t]=r;},'get_custom_renderer':function(t,d,ctx){if(!_custom_renderers[t]){return null;}
var custom=_custom_renderers[t];return custom(d,ctx);},'set_custom_exclusions':function(t,e){if(!_exclusions[t]){return;}
if((!e)||(typeof(e)!="function")){return;}
_exclusions[t]=e;},'get_custom_exclusion':function(t,d,ctx){if(!_exclusions[t]){return null;}
var exclude=_exclusions[t];return exclude(d,ctx);},'apply':function(data,target){var el=document.getElementById(target);if(!el){return false;}
var pretty=self.render(data);el.appendChild(pretty);return true;},'render':function(props){var pretty=document.createElement("div");pretty.setAttribute("id","render-pretty");buckets=self.bucket_props(props);var namespaces=Object.keys(buckets);namespaces=namespaces.sort();var count_ns=namespaces.length;for(var i=0;i<count_ns;i++){var ns=namespaces[i];var dom=self.render_bucket(ns,buckets[ns]);pretty.appendChild(dom);}
return pretty;},'render_bucket':function(ns,bucket){var details=document.createElement("details");details.setAttribute("style","margin-bottom:1rem;");if(ns!='_global_'){var summary=document.createElement("summary");summary.setAttribute("id",ns);var anchor=document.createElement("a");anchor.setAttribute("href","#"+ns);anchor.setAttribute("class","anchor");anchor.appendChild(document.createTextNode("¶"));var content=document.createTextNode(ns);var header=document.createElement("h3");header.setAttribute("style","display:inline");header.appendChild(content);summary.appendChild(header);details.appendChild(summary);}
var menu=document.createElement("details-menu");var sorted=self.sort_bucket(bucket);var body=self.render_data(sorted,ns);menu.appendChild(body);details.appendChild(menu);return details;},'render_data':function(d,ctx){if(Array.isArray(d)){return self.render_list(d,ctx);}
else if(typeof(d)=="object"){return self.render_dict(d,ctx);}
else{var wrapper=document.createElement("span");wrapper.setAttribute("class","render-content");var content;var renderer=self.get_custom_renderer('text',d,ctx);if(renderer){try{content=renderer(d,ctx);}catch(e){}}
else{content=self.render_text(d,ctx);}
wrapper.appendChild(content);return wrapper;}},'render_dict':function(d,ctx){var table=document.createElement("table");table.setAttribute("class","table table-sm");for(k in d){var row=document.createElement("tr");var label_text=k;var _ctx=(ctx)?ctx+"."+k:k;var renderer=self.get_custom_renderer('dict',d,_ctx);if(renderer){try{label_text=renderer(d,_ctx);}catch(e){}}
var header=document.createElement("th");var label=document.createTextNode(self.htmlspecialchars(label_text));header.appendChild(label);var content=document.createElement("td");var body=self.render_data(d[k],_ctx);content.appendChild(body);row.appendChild(header);row.appendChild(content);table.appendChild(row);}
var wrapper=document.createElement("div");wrapper.setAttribute("class","table-responsive");wrapper.appendChild(table);return wrapper;},'render_list':function(d,ctx){var count=d.length;if(count==0){return self.render_text("–",ctx);}
if(count<=1){return self.render_data(d[0],ctx);}
var list=document.createElement("ul");for(var i=0;i<count;i++){var item=document.createElement("li");var body=self.render_data(d[i],ctx+"#"+i);item.appendChild(body);list.appendChild(item);}
return list;},'render_text':function(d,ctx){var text=self.htmlspecialchars(d);var span=document.createElement("span");span.setAttribute("id",ctx);span.setAttribute("title",ctx);span.setAttribute("class","yesnofix-uoc");var el=document.createTextNode(text);span.appendChild(el);return span;},'render_link':function(link,text,ctx){var anchor=document.createElement("a");anchor.setAttribute("href",link);anchor.setAttribute("target","_wof");var body=self.render_text(text,ctx);anchor.appendChild(body);return anchor;},'render_code':function(text,ctx){var code=document.createElement("code");var body=self.render_text(text,ctx);code.appendChild(body);return code;},'render_timestamp':function(text,ctx){var dt=new Date(parseInt(text)*1000);return self.render_text(dt.toISOString(),ctx);},'bucket_props':function(props){buckets={};for(k in props){parts=k.split(":",2);ns=parts[0];pred=parts[1];if(parts.length!=2){ns="_global_";pred=k;}
if(!buckets[ns]){buckets[ns]={};}
buckets[ns][pred]=props[k];}
return buckets;},'sort_bucket':function(bucket){var sorted={};var keys=Object.keys(bucket);keys=keys.sort();var count_keys=keys.length;for(var j=0;j<count_keys;j++){var k=keys[j];sorted[k]=bucket[k];}
return sorted;},'htmlspecialchars':function(string,quote_style,charset,double_encode){var optTemp=0,i=0,noquotes=false;if(typeof quote_style==='undefined'||quote_style===null){quote_style=2;}
string=string.toString();if(double_encode!==false){string=string.replace(/&/g,'&amp;');}
string=string.replace(/</g,'&lt;').replace(/>/g,'&gt;');var OPTS={'ENT_NOQUOTES':0,'ENT_HTML_QUOTE_SINGLE':1,'ENT_HTML_QUOTE_DOUBLE':2,'ENT_COMPAT':2,'ENT_QUOTES':3,'ENT_IGNORE':4};if(quote_style===0){noquotes=true;}
if(typeof quote_style!=='number'){quote_style=[].concat(quote_style);for(i=0;i<quote_style.length;i++){if(OPTS[quote_style[i]]===0){noquotes=true;}else if(OPTS[quote_style[i]]){optTemp=optTemp|OPTS[quote_style[i]];}}
quote_style=optTemp;}
if(quote_style&OPTS.ENT_HTML_QUOTE_SINGLE){string=string.replace(/'/g,'&#039;');}
if(!noquotes){string=string.replace(/"/g,'&quot;');}
return string;}}
return self;})();var whosonfirst=whosonfirst||{};whosonfirst.uri=(function(){var _endpoint="https://data.whosonfirst.org/";var self={'endpoint':function(e){if(e){_endpoint=e;}
return _endpoint;},'id2abspath':function(id,args){var rel_path=self.id2relpath(id,args);var abs_path=self.endpoint()+rel_path;return abs_path;},'id2relpath':function(id,args){parent=self.id2parent(id);fname=self.id2fname(id,args);var rel_path=parent+"/"+fname;return rel_path;},'id2parent':function(id){str_id=new String(id);tmp=new Array();while(str_id.length){var part=str_id.substr(0,3);tmp.push(part);str_id=str_id.substr(3);}
parent=tmp.join("/");return parent;},'id2fname':function(id,args){if(!args){args={};}
var fname=[encodeURIComponent(id)];if(args["alt"]){fname.push("alt");if(args["source"]){var source=encodeURIComponent(args["source"]);fname.push(source);if(args["function"]){var func=encodeURIComponent(args["function"]);fname.push(func);if((args["extras"])&&(args["extras"].join)){var extras=args["extras"];var count=extras.length;for(var i=0;i<count;i++){var extra=encodeURIComponent(extras[i]);fname.push(extra);}}}}
else{console.log("missing source parameter for alternate geometry");fname.push("unknown");}}
var str_fname=fname.join("-");return str_fname+".geojson";}};return self;})();class WhosOnFirstExistentialFlag extends HTMLElement{constructor(){super();}
connectedCallback(){var id=this.getAttribute("data-id");const shadow=this.attachShadow({mode:'open'});var select=document.createElement('select');select.setAttribute("class","form-select wof-property");select.setAttribute("style","display: block; padding: .3rem; font-size: 1rem; width: 100%;");const flags=["-1","0","1"];const labels={"-1":"unknown","0":"false","1":"true"};for(var i in flags){var option=document.createElement("option");option.setAttribute("value",flags[i]);option.appendChild(document.createTextNode(labels[flags[i]]));select.appendChild(option);}
select.onchange=function(){var textarea=document.getElementById(id);textarea.value=parseInt(select.value);};shadow.appendChild(select);}}
customElements.define('whosonfirst-existential-flag',WhosOnFirstExistentialFlag);window.addEventListener("load",function load(event){class WhosOnFirstPlacetype extends HTMLElement{constructor(){super();}
connectedCallback(){var wasm_uri=whosonfirst.browser.uris.forCustomLabel("placetypes_wasm");var _self=this;var placetypes_cb=function(placetypes){var count=placetypes.length;var id=_self.getAttribute("data-id");const shadow=_self.attachShadow({mode:'open'});var select=document.createElement('select');select.setAttribute("class","form-select wof-property");select.setAttribute("style","display: block; padding: .3rem; font-size: 1rem; width: 100%;");var opt=document.createElement("option");select.appendChild(opt);for(var i=0;i<count;i++){var pt=placetypes[i];var name=pt["name"];var opt=document.createElement("option");opt.value=name;opt.appendChild(document.createTextNode(name));select.appendChild(opt);}
select.onchange=function(){var textarea=document.getElementById(id);textarea.value=select.value;};shadow.appendChild(select);};var wasm_cb=function(){whosonfirst_placetypes_descendants("planet","common,common_optional,optional").then((data)=>{var placetypes=JSON.parse(data);placetypes_cb(placetypes);}).catch((err)=>{console.log(err);});};sfomuseum.wasm.fetch(wasm_uri).then(()=>{wasm_cb();}).catch((err)=>{console.log("Failed to fetch ",wasm_uri,err);});}};customElements.define('whosonfirst-placetype',WhosOnFirstPlacetype);});var whosonfirst=whosonfirst||{};whosonfirst.www=(function(){var self={'init':function(){},'abs_root_url':function(){var body=document.body;return body.getAttribute("data-abs-root-url");},};return self;})();